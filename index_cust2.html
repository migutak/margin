<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
		<title>MarginIQ Client</title>
		<meta name="generator" content="Bootply" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
		
		<!-- Angular 
	  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.6/angular.min.js"></script>-->
	  <script src="bower_components/angular/angular.js"></script>
    <script src="bower_components/angular-animate/angular-animate.js"></script>
	  <script src="angular-ui-notification/dist/angular-ui-notification.min.js"></script>  
	  <script src="angular-confirm/angular-confirm.js"></script> 
	  <link href="dist/angular-busy.css" rel="stylesheet">
    <script src="dist/angular-busy.js"></script>
	  <!-- UI-Router -->
	  <script src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.8/angular-ui-router.min.js"></script>
	  <script src="https://cdn.firebase.com/js/client/2.0.4/firebase.js"></script>
	  <script src="https://cdn.firebase.com/libs/angularfire/1.1.3/angularfire.min.js"></script>
	  
	  	<!-- script references -->
		<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		
		<script src="plugins/select2/select2.full.min.js" type="text/javascript"></script> 
		
		
		<link rel="stylesheet" href="jqwidgets/styles/jqx.base.css" type="text/css" />
    <script type="text/javascript" src="scripts/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="scripts/demos.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxcore.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxdatetimeinput.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxcalendar.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxtooltip.js"></script>
    <script type="text/javascript" src="jqwidgets/globalization/globalize.js"></script>
    
		<!--[if lt IE 9]>
			<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		
		<link href="css/styles.css" rel="stylesheet">
		<link rel="stylesheet" href="css/cust.css" type="text/css" />
		
		 <script src="plugins/datepicker/bootstrap-datepicker.js" type="text/javascript"></script>
   	 <link href="plugins/datepicker/datepicker3.css" rel="stylesheet" type="text/css" />
   	 
   	 <!-- Multiselect -->
	   <script type="text/javascript" src="assets/dist/js/bootstrap-select.min.js"></script>
     <link rel="stylesheet" href="assets/dist/css/bootstrap-select.css" type="text/css">
     
    <!-- Select2 -->
    <link href="plugins/select2/select2.min.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="js/cust1.js"></script>
		
		<!-- App Script -->
    <script type="text/javascript" src="js/cust.js"></script>  
    <script type="text/javascript" src="controllers/controllers.js"></script>
	  <script type="text/javascript" src="services/services.js"></script>
	
	</head>
	<body ng-app="myapp" ng-controller="indexcustCtrl">
<!-- Header -->
<div id="top-nav" class="navbar navbar-inverse navbar-static-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="icon-toggle"></span>
      </button>
      <a class="navbar-brand" href="#">MarginIQ</a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a class="dropdown-toggle" role="button" data-toggle="dropdown" href="#">
            <i class="glyphicon glyphicon-user"></i> Username <span class="caret"></span></a>
          <ul id="g-account-menu" class="dropdown-menu" role="menu">
            <li><a href="#">My Profile</a></li>
            <li><a href="#"><i class="glyphicon glyphicon-lock"></i> Logout</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div><!-- /container -->
</div>
<!-- /Header -->

<!-- Main -->
<div class="container">
  
  <!-- upper section -->
  <div class="row">
	<div class="col-sm-3">
      <!-- left -->
      <h3><i class="glyphicon glyphicon-briefcase"></i> Menu</h3>
      <hr>
      
      <ul class="nav nav-stacked">
        <li><a href="javascript:;"><i class="glyphicon glyphicon-flash"></i> Orders</a></li>
        <li><a href="javascript:;"><i class="glyphicon glyphicon-link"></i> Confirmations</a></li>
      </ul>

      
  	</div><!-- /span-3 -->
    <div class="col-sm-9">
      	
      <!-- column 2 -->	
       <h3><i class="glyphicon glyphicon-dashboard"></i> New FXSpot</h3>  
            
       <hr>
      
	   <div class="row">
            <!-- center left-->	
         	<div class="col-md-12">
			      <div class="stepwizard">
                <div class="stepwizard-row setup-panel">
                    <div class="stepwizard-step">
                        <a href="#step-1" type="button" class="btn btn-primary btn-circle">1</a>
                        <p>Quote Request</p>
                    </div>
                    <div class="stepwizard-step">
                        <a href="#step-2" type="button" class="btn btn-default btn-circle" disabled="disabled">2</a>
                        <p>Bank Selection</p>
                    </div>
                    <div class="stepwizard-step">
                        <a href="#step-3" type="button" class="btn btn-default btn-circle" disabled="disabled">3</a>
                        <p>Confirmation</p>
                    </div>
                </div>
            </div>
            <form role="form" action="" method="post" id="neworderform" class="form-horizontal" ng-controller="neworderCtrl">
                <div class="row setup-content" id="step-1">
                    <div class="col-xs-12">
                        <div class="col-md-12">
                            <div class="form-group">
                				        <label class="col-xs-3 control-label">Buy/Sell</label>
                				        <div class="col-xs-5 selectContainer">
                				            <select name="colors" class="form-control" ng-model="neworder.buysell" id="buysell" name="buysell" required>
                				                <option>BUY</option>
                							          <option>SELL</option>
                				            </select>
                				        </div>
                				    </div>
                            <div class="form-group">
                				    	<label class="col-xs-3 control-label">Currency pair</label>
                				    	<div class="col-xs-5 selectContainer">
                				    		<select class="form-control" ng-model="neworder.ccypair" id="ccypair" name="ccypair" required>
                							    <option>USD/KES</option>
                  								<option>KES/UGX</option>
                  								<option>KES/TZS</option>
                  								<option>EUR/KES</option>
                  								<option>GBP/KES</option>
                  								<option>CAD/KES</option>
                  								<option>AUD/KES</option>
                  								<option>ZAR/KES</option>
                  								<option>JPY/KES</option>
                  								<option>RUB/KES</option>
                  								<option>BRL/KES</option>
                  								<option>EUR/USD</option>
                  								<option>GBP/USD</option>
                							  </select>
                				    	</div>
                				    </div>
                				    <div class="form-group">
                				    	<label class="col-xs-3 control-label">Buy Amount ({{ccytitle | limitTo:num}})</label>
                				    	<div class="col-xs-5 selectContainer">
                				    		<input type="text" class="form-control" ng-model="neworder.buyorderamount" id="buyorderamount" name="buyorderamount" ng-disabled = "s_buy" ng-blur="setfunct()">
                				    	</div>
                				    </div>
                				    <div class="form-group">
                				    	<label class="col-xs-3 control-label">Sell Amount ({{ccytitle | limitTo:-num}})</label>
                				    	<div class="col-xs-5 selectContainer">
                				    		<input type="text" class="form-control" ng-model="neworder.sellorderamount" id="sellorderamount" name="sellorderamount" ng-disabled = "s_sell" ng-blur="setfunct2()">
                				    	</div>
                				    </div>
                				    <div class="form-group">
                				    	<label class="col-xs-3 control-label">Settlement Date</label>
                				    	<div class="col-xs-5 selectContainer">
                				    		<div id='dateInput' name="dateInput" ng-model="neworder.settlementdate"></div>
                				    	</div>
                				    </div>
                				    
                            
                            
                            
                            <button class="btn btn-primary nextBtn pull-right" type="button" >Next</button>
                        </div>
                    </div>
                </div>
                <div class="row setup-content" id="step-2">
                    <div class="col-xs-12">
                        <div class="col-md-12">
                           
                           <div class="form-group">
                				    	<label class="col-xs-3 control-label">Select Bank(s)</label>
                				    	<div class="col-xs-5 selectContainer">
                						      <select class="form-control select2" multiple="multiple" data-placeholder="Select Bank(s)" ng-model="neworder.bankselected">
                		                  <option ng-repeat="option in banks" value="{{option.username}}">{{option.username}}</option>
                		              </select>
                				    	</div>
                				    </div>
                            <div class="form-group">
                            	<label class="col-xs-3 control-label">Comment</label>
                            	<div class="col-xs-5 selectContainer">
                            		<textarea class="form-control" rows="3" placeholder="Enter ..." ng-model="neworder.custcomment" id="custcomment" name="custcomment"></textarea>
                            	</div>
                            </div> 
                            
                            <button class="btn btn-primary nextBtn pull-right" type="button" >Next</button>
                        </div>
                    </div>
                </div>
                <div class="row setup-content" id="step-3">
                    <div class="col-xs-12">
                        <div class="col-md-12">
                            Buy/sell:   {{neworder.buysell}}<br>
                            CCYPair:    {{neworder.ccypair}}<br>
                            Buy Amount:   {{neworder.buyorderamount}}<br>
                            Sell Amount:   {{neworder.sellorderamount}}<br>
                            Request to:   {{neworder.bankselected}}<br>
                            Settlement Date:   {{neworder.settlementdate}}<br>
                            Comment:   {{neworder.custcomment}}
                            <button class="btn btn-success pull-right" type="submit" id="finish" name="finish" >Finish!</button>
                        </div>
                    </div>
                </div>
            </form>
              
                                 
              
          </div><!--/col-->
         
          
     
       </div><!--/row-->
  	</div><!--/col-span-9-->
    
  </div><!--/row-->
  <!-- /upper section -->
  
  <!-- lower section -->
  <div class="row">
    
    <div class="col-md-12">
      <hr>
      <a href="#"><strong><i class="glyphicon glyphicon-list-alt"></i> Open Orders</strong></a>  
      <hr>    
    </div>
    <div class="col-md-8" ng-controller="custCtrl">
      <input ng-model="searchKeyword" type="text" placeholder="Filter by" autofocus>
      <table class="table table-striped">
        <thead>
                                    <th>View</th>
                                    <th>Currency Pair</th>
                                    <th>Buy/Sell</th>
                                    <th>Settlement Date</th>
                                    <th>Buy Amount</th>
                                    <th>Sell Amount</th>
                                    <th>Expires</th>
        </thead>
        <tbody>
                                <tr ng-repeat="ord in custorders | filter: searchKeyword">
                                    <td>
                                        <!--<button class="btn btn-info" ng-click="viewoffers(ord.orderid)"><i class="fa fa-external-link"></i> <span class="badge">{{ord.nOffers}}</span></button>-->
                                        <div class="dropdown">
                                          <button class="btn btn-info btn-flat dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            View Deal <span class="badge">{{ord.nOffers}}</span>
                                            <span class="caret"></span>
                                          </button>
                                          <ul class="dropdown-menu" aria-labelledby="dropdownMenu2">
                                            <li><a href="" ng-click="viewoffers(ord.orderid)">View Offers</a></li>
                                            <li><a data-toggle="modal" data-target="#myModal" class="announce" data-id="107">Withdraw Order</a></li>
                                          </ul>
                                        </div>
                                    </td>
                                    <td>{{ord.ccypair}}</td>
                                    <td>{{ord.buysell}}</td>
                                    <td>{{ord.settlementdate}}</td>
                                    <td>{{ord.ccypair | limitTo:ord.limitnum}} {{ord.buyorderamount | number}}</td>
                                    <td>{{ord.ccypair | limitTo:-ord.limitnum}} {{ord.sellorderamount | number}}</td>
                                    <td style="background-color:red;">{{fiddletime|timeago:true}}</td>
                                </tr>
        </tbody>
      </table>

    
    </div>
    <div class="col-md-4" ng-controller="custCtrl">
      <!--tabs-->
      <div class="container">
        <ul class="nav nav-tabs" id="myTab">
          <li class="active"><a href="#profile" data-toggle="tab">Offers {{offertitle}}</a></li>
          <!--<li><a href="#messages" data-toggle="tab">Messages</a></li>
          <li><a href="#settings" data-toggle="tab">Settings</a></li>-->
        </ul>
        
        <div class="tab-content">
          <input ng-model="query" type="text" placeholder="Search ..." autofocus>
          <div class="tab-pane active" id="profile">
            
                            <table class="table table-striped">
                                <tr>
                                    <th>Bank</th>
                                    <th>Rate</th>
                                    <th>Settlement Amount</th>
                                    <th>Date of Offer</th>
                                    <th>Expiry Date</th>
                                    <th></th>
                                </tr>
                                <tr ng-repeat="ord in orderdetails | filter:query">
                                    <td>{{ord.offeredby}}</td>
                                    <td>{{ord.offeredrate}}</td>
                                    <td>{{ord.ccysettleamount}} {{ord.settleamount | number}}</td>
                                    <td>{{ord.createdate}}</td>
                                    <td>{{ord.settlementdate}}</td>
                                    <td>
                                        <div class="btn-group pull-left">
                                            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-gears"></i></a>
                                            <ul class="dropdown-menu icons-right dropdown-menu-right">
                                                <li><a href="#"><i class="fa fa-commenting"></i> Chat</a></li>
                                                <li><a href="#/offeraccept/{{ord.offerid}}"><i class="fa fa-check"></i> Accept</a></li>
                                            </ul>
                                        </div>
                                    </td>
                                </tr>
                            </table>
          </div>
          <!--<div class="tab-pane" id="messages">
            <h4><i class="glyphicon glyphicon-comment"></i></h4>
            Message ipsum dolor sit amet, consectetur adipiscing elit. Duis pharetra varius quam sit amet vulputate. 
            <p>Quisque mauris augue, molestie tincidunt condimentum vitae, gravida a libero. Aenean sit amet felis 
              dolor, in sagittis nisi. Sed ac orci quis tortor imperdiet venenatis. Duis elementum auctor accumsan. 
              Aliquam in felis sit amet augue.</p>
          </div>
          <div class="tab-pane" id="settings">
            <h4><i class="glyphicon glyphicon-cog"></i></h4>
            Lorem settings dolor sit amet, consectetur adipiscing elit. Duis pharetra varius quam sit amet vulputate. 
            <p>Quisque mauris augue, molestie tincidunt condimentum vitae, gravida a libero. Aenean sit amet felis 
              dolor, in sagittis nisi. Sed ac orci quis tortor imperdiet venenatis. Duis elementum auctor accumsan. 
              Aliquam in felis sit amet augue.</p>
          </div>-->
        </div>
      </div>
      <!--/tabs-->
      
      
      
    
    </div><!--/col-->
    
  </div><!--/row-->
  
</div><!--/container-->
<!-- /Main -->


<!--<footer class="text-center"><a href="http://"><strong>MarginIQ.com</strong></a></footer>-->

  
 
    <script>
        $(".datepicker").datepicker({
          autoclose: true,
          format:'dd-mm-yyyy',
          daysOfWeekDisabled:[0,6],
          clearBtn: true,
          orientation: "auto top",
          todayHighlight:true,
          startDate: '0d',
          endDate: '+7d'
        });
        
  </script>
  
  
  <script type="text/javascript">
            $(document).ready(function () {               
                // Create a jqxDateTimeInput
                $("#dateInput").jqxDateTimeInput({ width: '320px', height: '30px' });
                //$("#timeInput").jqxDateTimeInput({formatString: "T", showTimeButton: true, showCalendarButton: false, width: '300px', height: '25px' });
                //$("#dateTimeInput").jqxDateTimeInput({ formatString: "F", showTimeButton: true, width: '300px', height: '25px' });
                
                $("#finish").click(function(e) {
                  e.preventDefault();
                  var d = new Date();
                  var n = d.getTime();
                  
                  var buysell = $("#buysell").val(); 
                  var settlementdate = $("#dateInput").val();
                  var orderid = n; //random based on current datetime as number
                  var usernamefk = "customer1";
                  var ccypair = $("#ccypair").val();
                  var buyorderamount = $("#buyorderamount").val();
                  var sellorderamount = $("#sellorderamount").val();
                  var buysellbank = "SELL";
                  var recipient = "bank1";
                  var custcomment = $("#custcomment").val();
                  var ordertypefk = "FXSPOT";
                  
                  var dataString = 'buysell='+buysell+'&settlementdate='+settlementdate+'&orderid='+orderid+'&usernamefk='+usernamefk+'&ccypair='+ccypair+'&buyorderamount='+buyorderamount
                    +'&sellorderamount='+sellorderamount+'&buysellbank='+buysellbank+'&recipient='+recipient+'&custcomment='+custcomment+'&ordertypefk='+ordertypefk;
                  
                  $.ajax({
                    type:'POST',
                    data:dataString,
                    url:'rest/neworder.php',
                    success:function(data) {
                      alert(data);
                      location.reload();
                    }
                  });
  
                })
            });
  </script>
  
	</body>
</html>